2025-03-25 10:49:49,187 | ppo_highway_ | INFO | Logging initialized. Log file: artifacts/highway-ppo/logs/20250325_104949.log
2025-03-25 10:49:49,188 | ppo_highway_ | INFO | Starting Highway-Env PPO Training
2025-03-25 10:49:49,188 | ppo_highway_ | INFO | State dimension: 60
2025-03-25 10:49:49,188 | ppo_highway_ | INFO | Action dimension: 2
2025-03-25 10:49:49,188 | ppo_highway_ | INFO | 
=== Running Single Training Session ===
2025-03-25 10:49:49,661 | ppo_highway_ | INFO | Starting training...
2025-03-25 10:49:49,661 | ppo_highway_ | INFO | Device: Apple Silicon GPU
2025-03-25 10:49:49,661 | ppo_highway_ | INFO | Max episodes: 300, Target reward: 0.0
2025-03-25 10:49:49,662 | ppo_highway_ | INFO | Environment: highway-v0
2025-03-25 10:49:49,662 | ppo_highway_ | INFO | Steps per update: 2048, PPO epochs: 6
2025-03-25 10:49:49,662 | ppo_highway_ | INFO | Learning rate: 0.0001, Gamma: 0.99, Lambda: 0.95
2025-03-25 10:49:49,662 | ppo_highway_ | INFO | Clip epsilon: 0.2, Value coef: 0.5, Entropy coef: 0.005
2025-03-25 10:49:49,662 | ppo_highway_ | INFO | Performing initial evaluation...
2025-03-25 10:50:10,947 | ppo_highway_ | INFO | Initial evaluation: Average Reward over 5 episodes: 6.35
2025-03-25 10:51:07,241 | ppo_highway_ | INFO | Episode 10 | Reward: 5.66 | Avg Episode Reward: 9.77 | Steps: 1628 | Episode Steps: 13 | Time: 77.58s
2025-03-25 10:51:22,038 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:51:24,854 | ppo_highway_ | INFO | Policy Update | Loss: 1.2436 | Policy Loss: -0.0019 | Value Loss: 2.5195 | Entropy: 2.8382 | Clip Fraction: 0.008 | Approx KL: 0.00125 | Explained Var: -0.000
2025-03-25 10:51:24,856 | ppo_highway_ | INFO | Policy update completed in 73.91s
2025-03-25 10:52:07,264 | ppo_highway_ | INFO | Episode 20 | Reward: 2.34 | Avg Episode Reward: 6.58 | Steps: 3268 | Episode Steps: 200 | Time: 137.60s
2025-03-25 10:52:36,525 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:52:39,032 | ppo_highway_ | INFO | Policy Update | Loss: 0.7248 | Policy Loss: -0.0016 | Value Loss: 1.4812 | Entropy: 2.8379 | Clip Fraction: 0.004 | Approx KL: 0.00078 | Explained Var: 0.064
2025-03-25 10:52:39,035 | ppo_highway_ | INFO | Policy update completed in 74.18s
2025-03-25 10:53:07,219 | ppo_highway_ | INFO | Episode 30 | Reward: 22.77 | Avg Episode Reward: 11.16 | Steps: 4896 | Episode Steps: 200 | Time: 197.56s
2025-03-25 10:53:52,576 | ppo_highway_ | INFO | Episode 40 | Reward: 0.82 | Avg Episode Reward: 6.47 | Steps: 6144 | Episode Steps: 11 | Time: 242.91s
2025-03-25 10:53:52,578 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:53:55,050 | ppo_highway_ | INFO | Policy Update | Loss: 1.0249 | Policy Loss: -0.0044 | Value Loss: 2.0870 | Entropy: 2.8362 | Clip Fraction: 0.025 | Approx KL: 0.00249 | Explained Var: 0.174
2025-03-25 10:53:55,053 | ppo_highway_ | INFO | Policy update completed in 76.02s
2025-03-25 10:54:59,178 | ppo_highway_ | INFO | Episode 50 | Reward: 1.37 | Avg Episode Reward: 5.75 | Steps: 7951 | Episode Steps: 200 | Time: 309.52s
2025-03-25 10:54:59,178 | ppo_highway_ | INFO | Evaluating at episode 50...
2025-03-25 10:55:33,015 | ppo_highway_ | INFO | Evaluation at episode 50: Average Reward: 3.09 | Moving Avg: 4.72
2025-03-25 10:55:33,028 | ppo_highway_ | INFO | Model checkpoint saved to artifacts/highway-ppo/ppo_highway_best.pth
2025-03-25 10:55:33,028 | ppo_highway_ | INFO | New best model saved with average reward: 4.72
2025-03-25 10:55:41,468 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:55:43,736 | ppo_highway_ | INFO | Policy Update | Loss: 0.4185 | Policy Loss: -0.0056 | Value Loss: 0.8766 | Entropy: 2.8360 | Clip Fraction: 0.010 | Approx KL: 0.00134 | Explained Var: 0.492
2025-03-25 10:55:43,739 | ppo_highway_ | INFO | Policy update completed in 108.69s
2025-03-25 10:56:15,548 | ppo_highway_ | INFO | Episode 60 | Reward: 7.40 | Avg Episode Reward: 8.19 | Steps: 9083 | Episode Steps: 33 | Time: 385.89s
2025-03-25 10:56:56,580 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:56:58,940 | ppo_highway_ | INFO | Policy Update | Loss: 0.8709 | Policy Loss: -0.0058 | Value Loss: 1.7818 | Entropy: 2.8391 | Clip Fraction: 0.033 | Approx KL: 0.00285 | Explained Var: 0.433
2025-03-25 10:56:58,943 | ppo_highway_ | INFO | Policy update completed in 75.20s
2025-03-25 10:57:06,182 | ppo_highway_ | INFO | Episode 70 | Reward: 12.11 | Avg Episode Reward: 9.78 | Steps: 10440 | Episode Steps: 200 | Time: 436.52s
2025-03-25 10:57:47,918 | ppo_highway_ | INFO | Episode 80 | Reward: 15.73 | Avg Episode Reward: 6.92 | Steps: 11582 | Episode Steps: 200 | Time: 478.26s
2025-03-25 10:58:13,878 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:58:16,469 | ppo_highway_ | INFO | Policy Update | Loss: 2.7566 | Policy Loss: -0.0075 | Value Loss: 5.5566 | Entropy: 2.8391 | Clip Fraction: 0.049 | Approx KL: 0.00403 | Explained Var: 0.438
2025-03-25 10:58:16,472 | ppo_highway_ | INFO | Policy update completed in 77.53s
2025-03-25 10:58:32,975 | ppo_highway_ | INFO | Episode 90 | Reward: 14.87 | Avg Episode Reward: 20.46 | Steps: 12723 | Episode Steps: 200 | Time: 523.31s
2025-03-25 10:59:26,663 | ppo_highway_ | INFO | Episode 100 | Reward: 49.08 | Avg Episode Reward: 13.55 | Steps: 14171 | Episode Steps: 200 | Time: 577.00s
2025-03-25 10:59:26,663 | ppo_highway_ | INFO | Evaluating at episode 100...
2025-03-25 10:59:35,122 | ppo_highway_ | INFO | Evaluation at episode 100: Average Reward: 12.38 | Moving Avg: 7.27
2025-03-25 10:59:35,134 | ppo_highway_ | INFO | Model checkpoint saved to artifacts/highway-ppo/ppo_highway_best.pth
2025-03-25 10:59:35,134 | ppo_highway_ | INFO | New best model saved with average reward: 7.27
2025-03-25 10:59:41,130 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 10:59:43,873 | ppo_highway_ | INFO | Policy Update | Loss: 2.0279 | Policy Loss: -0.0033 | Value Loss: 4.0908 | Entropy: 2.8366 | Clip Fraction: 0.021 | Approx KL: 0.00217 | Explained Var: 0.629
2025-03-25 10:59:43,876 | ppo_highway_ | INFO | Policy update completed in 87.40s
2025-03-25 11:00:19,411 | ppo_highway_ | INFO | Episode 110 | Reward: 52.62 | Avg Episode Reward: 19.54 | Steps: 15299 | Episode Steps: 200 | Time: 629.75s
2025-03-25 11:00:59,938 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:01:02,639 | ppo_highway_ | INFO | Policy Update | Loss: 4.3517 | Policy Loss: -0.0045 | Value Loss: 8.7408 | Entropy: 2.8351 | Clip Fraction: 0.031 | Approx KL: 0.00308 | Explained Var: 0.562
2025-03-25 11:01:02,642 | ppo_highway_ | INFO | Policy update completed in 78.77s
2025-03-25 11:01:03,211 | ppo_highway_ | INFO | Episode 120 | Reward: 7.32 | Avg Episode Reward: 22.23 | Steps: 16399 | Episode Steps: 15 | Time: 673.55s
2025-03-25 11:01:57,290 | ppo_highway_ | INFO | Episode 130 | Reward: 12.99 | Avg Episode Reward: 15.82 | Steps: 17846 | Episode Steps: 200 | Time: 727.63s
2025-03-25 11:02:20,665 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:02:23,382 | ppo_highway_ | INFO | Policy Update | Loss: 2.6510 | Policy Loss: -0.0017 | Value Loss: 5.3337 | Entropy: 2.8354 | Clip Fraction: 0.004 | Approx KL: 0.00096 | Explained Var: 0.627
2025-03-25 11:02:23,385 | ppo_highway_ | INFO | Policy update completed in 80.74s
2025-03-25 11:03:09,557 | ppo_highway_ | INFO | Episode 140 | Reward: 12.53 | Avg Episode Reward: 24.15 | Steps: 19632 | Episode Steps: 200 | Time: 799.90s
2025-03-25 11:03:43,290 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:03:46,602 | ppo_highway_ | INFO | Policy Update | Loss: 2.7517 | Policy Loss: -0.0039 | Value Loss: 5.5397 | Entropy: 2.8356 | Clip Fraction: 0.019 | Approx KL: 0.00213 | Explained Var: 0.703
2025-03-25 11:03:46,605 | ppo_highway_ | INFO | Policy update completed in 83.22s
2025-03-25 11:04:10,044 | ppo_highway_ | INFO | Episode 150 | Reward: 33.47 | Avg Episode Reward: 19.01 | Steps: 21080 | Episode Steps: 200 | Time: 860.38s
2025-03-25 11:04:10,044 | ppo_highway_ | INFO | Evaluating at episode 150...
2025-03-25 11:04:19,328 | ppo_highway_ | INFO | Evaluation at episode 150: Average Reward: 14.93 | Moving Avg: 9.19
2025-03-25 11:04:19,341 | ppo_highway_ | INFO | Model checkpoint saved to artifacts/highway-ppo/ppo_highway_best.pth
2025-03-25 11:04:19,341 | ppo_highway_ | INFO | New best model saved with average reward: 9.19
2025-03-25 11:05:13,117 | ppo_highway_ | INFO | Episode 160 | Reward: 4.22 | Avg Episode Reward: 22.33 | Steps: 22528 | Episode Steps: 27 | Time: 923.46s
2025-03-25 11:05:13,119 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:05:15,611 | ppo_highway_ | INFO | Policy Update | Loss: 3.7701 | Policy Loss: -0.0053 | Value Loss: 7.5791 | Entropy: 2.8350 | Clip Fraction: 0.025 | Approx KL: 0.00278 | Explained Var: 0.736
2025-03-25 11:05:15,614 | ppo_highway_ | INFO | Policy update completed in 89.01s
2025-03-25 11:05:57,877 | ppo_highway_ | INFO | Episode 170 | Reward: 26.67 | Avg Episode Reward: 22.08 | Steps: 23673 | Episode Steps: 200 | Time: 968.22s
2025-03-25 11:06:31,255 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:06:34,005 | ppo_highway_ | INFO | Policy Update | Loss: 5.5300 | Policy Loss: -0.0031 | Value Loss: 11.0945 | Entropy: 2.8352 | Clip Fraction: 0.040 | Approx KL: 0.00350 | Explained Var: 0.679
2025-03-25 11:06:34,008 | ppo_highway_ | INFO | Policy update completed in 78.39s
2025-03-25 11:06:41,492 | ppo_highway_ | INFO | Episode 180 | Reward: 36.25 | Avg Episode Reward: 25.53 | Steps: 24776 | Episode Steps: 200 | Time: 1011.83s
2025-03-25 11:07:20,466 | ppo_highway_ | INFO | Episode 190 | Reward: 52.56 | Avg Episode Reward: 32.01 | Steps: 25851 | Episode Steps: 200 | Time: 1050.80s
2025-03-25 11:07:49,698 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:07:52,398 | ppo_highway_ | INFO | Policy Update | Loss: 5.9723 | Policy Loss: -0.0044 | Value Loss: 11.9817 | Entropy: 2.8358 | Clip Fraction: 0.017 | Approx KL: 0.00202 | Explained Var: 0.738
2025-03-25 11:07:52,401 | ppo_highway_ | INFO | Policy update completed in 78.39s
2025-03-25 11:07:59,757 | ppo_highway_ | INFO | Episode 200 | Reward: 66.43 | Avg Episode Reward: 26.30 | Steps: 26824 | Episode Steps: 200 | Time: 1090.10s
2025-03-25 11:07:59,757 | ppo_highway_ | INFO | Evaluating at episode 200...
2025-03-25 11:08:15,371 | ppo_highway_ | INFO | Evaluation at episode 200: Average Reward: 36.46 | Moving Avg: 14.64
2025-03-25 11:08:15,382 | ppo_highway_ | INFO | Model checkpoint saved to artifacts/highway-ppo/ppo_highway_best.pth
2025-03-25 11:08:15,382 | ppo_highway_ | INFO | New best model saved with average reward: 14.64
2025-03-25 11:08:45,209 | ppo_highway_ | INFO | Episode 210 | Reward: 10.67 | Avg Episode Reward: 17.95 | Steps: 27612 | Episode Steps: 39 | Time: 1135.55s
2025-03-25 11:09:25,889 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:09:28,551 | ppo_highway_ | INFO | Policy Update | Loss: 7.3043 | Policy Loss: -0.0003 | Value Loss: 14.6375 | Entropy: 2.8356 | Clip Fraction: 0.014 | Approx KL: 0.00169 | Explained Var: 0.712
2025-03-25 11:09:28,554 | ppo_highway_ | INFO | Policy update completed in 96.15s
2025-03-25 11:09:43,754 | ppo_highway_ | INFO | Episode 220 | Reward: 49.40 | Avg Episode Reward: 42.90 | Steps: 29072 | Episode Steps: 200 | Time: 1194.09s
2025-03-25 11:10:32,449 | ppo_highway_ | INFO | Episode 230 | Reward: 33.49 | Avg Episode Reward: 33.00 | Steps: 30344 | Episode Steps: 200 | Time: 1242.79s
2025-03-25 11:10:47,318 | ppo_highway_ | INFO | Updating policy after collecting 2048 steps...
2025-03-25 11:10:50,035 | ppo_highway_ | INFO | Policy Update | Loss: 6.0195 | Policy Loss: 0.0003 | Value Loss: 12.0668 | Entropy: 2.8350 | Clip Fraction: 0.046 | Approx KL: 0.00414 | Explained Var: 0.791
2025-03-25 11:10:50,038 | ppo_highway_ | INFO | Policy update completed in 81.48s
2025-03-25 11:11:09,384 | ppo_highway_ | INFO | Episode 240 | Reward: 10.83 | Avg Episode Reward: 20.45 | Steps: 31226 | Episode Steps: 18 | Time: 1279.72s
